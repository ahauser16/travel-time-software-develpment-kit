/**
* TravelTime Platform API
* No description provided (generated by Openapi Generator https://github.com/openapitools/openapi-generator)
*
* OpenAPI spec version: 1.0.0
* Contact: support@igeolise.com
*
* NOTE: This class is auto generated by OpenAPI Generator (https://openapi-generator.tech).
* https://openapi-generator.tech
* Do not edit the class manually.
*/
package traveltimeplatform.apis

import com.google.gson.Gson
import io.ktor.application.call
import io.ktor.auth.UserIdPrincipal
import io.ktor.auth.authentication
import io.ktor.auth.basicAuthentication
import io.ktor.auth.oauth
import io.ktor.auth.OAuthAccessTokenResponse
import io.ktor.auth.OAuthServerSettings
import io.ktor.http.ContentType
import io.ktor.http.HttpStatusCode
import io.ktor.locations.*
import io.ktor.response.respond
import io.ktor.response.respondText
import io.ktor.routing.*

import kotlinx.coroutines.experimental.asCoroutineDispatcher

import traveltimeplatform.ApplicationAuthProviders
import traveltimeplatform.Paths
import traveltimeplatform.ApplicationExecutors
import traveltimeplatform.HTTP.client
import traveltimeplatform.infrastructure.ApiPrincipal
import traveltimeplatform.infrastructure.apiKeyAuth

// ktor 0.9.x is missing io.ktor.locations.DELETE, this adds it.
// see https://github.com/ktorio/ktor/issues/288
import traveltimeplatform.delete

import traveltimeplatform.models.RequestRoutes
import traveltimeplatform.models.RequestSupportedLocations
import traveltimeplatform.models.RequestTimeFilter
import traveltimeplatform.models.RequestTimeFilterFast
import traveltimeplatform.models.RequestTimeFilterPostcodeDistricts
import traveltimeplatform.models.RequestTimeFilterPostcodeSectors
import traveltimeplatform.models.RequestTimeFilterPostcodes
import traveltimeplatform.models.RequestTimeMap
import traveltimeplatform.models.ResponseError
import traveltimeplatform.models.ResponseGeocoding
import traveltimeplatform.models.ResponseMapInfo
import traveltimeplatform.models.ResponseRoutes
import traveltimeplatform.models.ResponseSupportedLocations
import traveltimeplatform.models.ResponseTimeFilter
import traveltimeplatform.models.ResponseTimeFilterFast
import traveltimeplatform.models.ResponseTimeFilterPostcodeDistricts
import traveltimeplatform.models.ResponseTimeFilterPostcodeSectors
import traveltimeplatform.models.ResponseTimeFilterPostcodes
import traveltimeplatform.models.ResponseTimeMap

fun Route.DefaultApi() {
    val gson = Gson()
    val empty = mutableMapOf<String, Any?>()

    get<Paths.geocodingReverseSearch> {  it: Paths.geocodingReverseSearch ->
        val principal = call.authentication.principal<ApiPrincipal>()
        val principal = call.authentication.principal<ApiPrincipal>()
        
        if (principal == null) {
            call.respond(HttpStatusCode.Unauthorized)
        } else {
            val exampleContentType = "application/json"
            val exampleContentString = """{
              "features" : [ {
                "geometry" : {
                  "coordinates" : [ 0.80082819046101150206595775671303272247314453125, 0.80082819046101150206595775671303272247314453125 ],
                  "type" : "type"
                },
                "type" : "type",
                "properties" : {
                  "continent" : "continent",
                  "country" : "country",
                  "city" : "city",
                  "county" : "county",
                  "postcode" : "postcode",
                  "house_number" : "house_number",
                  "label" : "label",
                  "macroregion" : "macroregion",
                  "score" : 6.02745618307040320615897144307382404804229736328125,
                  "country_code" : "country_code",
                  "features" : {
                    "public_transport" : {
                      "date_start" : "2000-01-23T04:56:07.000+00:00",
                      "date_end" : "2000-01-23T04:56:07.000+00:00"
                    },
                    "fares" : true,
                    "postcodes" : true
                  },
                  "street" : "street",
                  "neighbourhood" : "neighbourhood",
                  "name" : "name",
                  "region" : "region",
                  "region_code" : "region_code"
                }
              }, {
                "geometry" : {
                  "coordinates" : [ 0.80082819046101150206595775671303272247314453125, 0.80082819046101150206595775671303272247314453125 ],
                  "type" : "type"
                },
                "type" : "type",
                "properties" : {
                  "continent" : "continent",
                  "country" : "country",
                  "city" : "city",
                  "county" : "county",
                  "postcode" : "postcode",
                  "house_number" : "house_number",
                  "label" : "label",
                  "macroregion" : "macroregion",
                  "score" : 6.02745618307040320615897144307382404804229736328125,
                  "country_code" : "country_code",
                  "features" : {
                    "public_transport" : {
                      "date_start" : "2000-01-23T04:56:07.000+00:00",
                      "date_end" : "2000-01-23T04:56:07.000+00:00"
                    },
                    "fares" : true,
                    "postcodes" : true
                  },
                  "street" : "street",
                  "neighbourhood" : "neighbourhood",
                  "name" : "name",
                  "region" : "region",
                  "region_code" : "region_code"
                }
              } ],
              "type" : "type"
            }"""
            
            when(exampleContentType) {
                "application/json" -> call.respond(gson.fromJson(exampleContentString, empty::class.java))
                "application/xml" -> call.respondText(exampleContentString, ContentType.Text.Xml)
                else -> call.respondText(exampleContentString)
            }
        }
    }
    .apply {
      // TODO: ktor doesn't allow different authentication registrations for endpoints sharing the same path but different methods.
      //       It could be the authentication block is being abused here. Until this is resolved, swallow duplicate exceptions.

        try {
            authentication {
                // "Implement API key auth (ApiKey) for parameter name 'X-Api-Key'."
                apiKeyAuth("X-Api-Key", "header") {
                    // TODO: "Verify key here , accessible as it.value"
                    if (it.value == "keyboardcat") {
                         ApiPrincipal(it)
                    } else {
                        null
                    }
                }
                // "Implement API key auth (ApplicationId) for parameter name 'X-Application-Id'."
                apiKeyAuth("X-Application-Id", "header") {
                    // TODO: "Verify key here , accessible as it.value"
                    if (it.value == "keyboardcat") {
                         ApiPrincipal(it)
                    } else {
                        null
                    }
                }
            }
        } catch(e: io.ktor.application.DuplicateApplicationFeatureException){
            application.environment.log.warn("authentication block for '/v4/geocoding/reverse' is duplicated in code. " +
            "Generated endpoints may need to be merged under a 'route' entry.")
        }
    }

    get<Paths.geocodingSearch> {  it: Paths.geocodingSearch ->
        val principal = call.authentication.principal<ApiPrincipal>()
        val principal = call.authentication.principal<ApiPrincipal>()
        
        if (principal == null) {
            call.respond(HttpStatusCode.Unauthorized)
        } else {
            val exampleContentType = "application/json"
            val exampleContentString = """{
              "features" : [ {
                "geometry" : {
                  "coordinates" : [ 0.80082819046101150206595775671303272247314453125, 0.80082819046101150206595775671303272247314453125 ],
                  "type" : "type"
                },
                "type" : "type",
                "properties" : {
                  "continent" : "continent",
                  "country" : "country",
                  "city" : "city",
                  "county" : "county",
                  "postcode" : "postcode",
                  "house_number" : "house_number",
                  "label" : "label",
                  "macroregion" : "macroregion",
                  "score" : 6.02745618307040320615897144307382404804229736328125,
                  "country_code" : "country_code",
                  "features" : {
                    "public_transport" : {
                      "date_start" : "2000-01-23T04:56:07.000+00:00",
                      "date_end" : "2000-01-23T04:56:07.000+00:00"
                    },
                    "fares" : true,
                    "postcodes" : true
                  },
                  "street" : "street",
                  "neighbourhood" : "neighbourhood",
                  "name" : "name",
                  "region" : "region",
                  "region_code" : "region_code"
                }
              }, {
                "geometry" : {
                  "coordinates" : [ 0.80082819046101150206595775671303272247314453125, 0.80082819046101150206595775671303272247314453125 ],
                  "type" : "type"
                },
                "type" : "type",
                "properties" : {
                  "continent" : "continent",
                  "country" : "country",
                  "city" : "city",
                  "county" : "county",
                  "postcode" : "postcode",
                  "house_number" : "house_number",
                  "label" : "label",
                  "macroregion" : "macroregion",
                  "score" : 6.02745618307040320615897144307382404804229736328125,
                  "country_code" : "country_code",
                  "features" : {
                    "public_transport" : {
                      "date_start" : "2000-01-23T04:56:07.000+00:00",
                      "date_end" : "2000-01-23T04:56:07.000+00:00"
                    },
                    "fares" : true,
                    "postcodes" : true
                  },
                  "street" : "street",
                  "neighbourhood" : "neighbourhood",
                  "name" : "name",
                  "region" : "region",
                  "region_code" : "region_code"
                }
              } ],
              "type" : "type"
            }"""
            
            when(exampleContentType) {
                "application/json" -> call.respond(gson.fromJson(exampleContentString, empty::class.java))
                "application/xml" -> call.respondText(exampleContentString, ContentType.Text.Xml)
                else -> call.respondText(exampleContentString)
            }
        }
    }
    .apply {
      // TODO: ktor doesn't allow different authentication registrations for endpoints sharing the same path but different methods.
      //       It could be the authentication block is being abused here. Until this is resolved, swallow duplicate exceptions.

        try {
            authentication {
                // "Implement API key auth (ApiKey) for parameter name 'X-Api-Key'."
                apiKeyAuth("X-Api-Key", "header") {
                    // TODO: "Verify key here , accessible as it.value"
                    if (it.value == "keyboardcat") {
                         ApiPrincipal(it)
                    } else {
                        null
                    }
                }
                // "Implement API key auth (ApplicationId) for parameter name 'X-Application-Id'."
                apiKeyAuth("X-Application-Id", "header") {
                    // TODO: "Verify key here , accessible as it.value"
                    if (it.value == "keyboardcat") {
                         ApiPrincipal(it)
                    } else {
                        null
                    }
                }
            }
        } catch(e: io.ktor.application.DuplicateApplicationFeatureException){
            application.environment.log.warn("authentication block for '/v4/geocoding/search' is duplicated in code. " +
            "Generated endpoints may need to be merged under a 'route' entry.")
        }
    }

    get<Paths.mapInfo> {  it: Paths.mapInfo ->
        val principal = call.authentication.principal<ApiPrincipal>()
        val principal = call.authentication.principal<ApiPrincipal>()
        
        if (principal == null) {
            call.respond(HttpStatusCode.Unauthorized)
        } else {
            val exampleContentType = "application/json"
            val exampleContentString = """{
              "maps" : [ {
                "features" : {
                  "public_transport" : {
                    "date_start" : "2000-01-23T04:56:07.000+00:00",
                    "date_end" : "2000-01-23T04:56:07.000+00:00"
                  },
                  "fares" : true,
                  "postcodes" : true
                },
                "name" : "name"
              }, {
                "features" : {
                  "public_transport" : {
                    "date_start" : "2000-01-23T04:56:07.000+00:00",
                    "date_end" : "2000-01-23T04:56:07.000+00:00"
                  },
                  "fares" : true,
                  "postcodes" : true
                },
                "name" : "name"
              } ]
            }"""
            
            when(exampleContentType) {
                "application/json" -> call.respond(gson.fromJson(exampleContentString, empty::class.java))
                "application/xml" -> call.respondText(exampleContentString, ContentType.Text.Xml)
                else -> call.respondText(exampleContentString)
            }
        }
    }
    .apply {
      // TODO: ktor doesn't allow different authentication registrations for endpoints sharing the same path but different methods.
      //       It could be the authentication block is being abused here. Until this is resolved, swallow duplicate exceptions.

        try {
            authentication {
                // "Implement API key auth (ApiKey) for parameter name 'X-Api-Key'."
                apiKeyAuth("X-Api-Key", "header") {
                    // TODO: "Verify key here , accessible as it.value"
                    if (it.value == "keyboardcat") {
                         ApiPrincipal(it)
                    } else {
                        null
                    }
                }
                // "Implement API key auth (ApplicationId) for parameter name 'X-Application-Id'."
                apiKeyAuth("X-Application-Id", "header") {
                    // TODO: "Verify key here , accessible as it.value"
                    if (it.value == "keyboardcat") {
                         ApiPrincipal(it)
                    } else {
                        null
                    }
                }
            }
        } catch(e: io.ktor.application.DuplicateApplicationFeatureException){
            application.environment.log.warn("authentication block for '/v4/map-info' is duplicated in code. " +
            "Generated endpoints may need to be merged under a 'route' entry.")
        }
    }

    route("/v4/routes") {
        post {
            val principal = call.authentication.principal<ApiPrincipal>()
            val principal = call.authentication.principal<ApiPrincipal>()
            
            if (principal == null) {
                call.respond(HttpStatusCode.Unauthorized)
            } else {
                val exampleContentType = "application/json"
                val exampleContentString = """{
                  "results" : [ {
                    "unreachable" : [ "unreachable", "unreachable" ],
                    "locations" : [ {
                      "id" : "id",
                      "properties" : [ {
                        "route" : {
                          "arrival_time" : "2000-01-23T04:56:07.000+00:00",
                          "parts" : [ {
                            "departs_at" : "departs_at",
                            "distance" : 2,
                            "line" : "line",
                            "num_stops" : 2,
                            "turn" : "turn",
                            "type" : "basic",
                            "travel_time" : 7,
                            "directions" : "directions",
                            "arrives_at" : "arrives_at",
                            "road" : "road",
                            "departure_station" : "departure_station",
                            "id" : "id",
                            "arrival_station" : "arrival_station",
                            "coords" : [ {
                              "lng" : 3.61607674925191080461672754609026014804840087890625,
                              "lat" : 9.301444243932575517419536481611430644989013671875
                            }, {
                              "lng" : 3.61607674925191080461672754609026014804840087890625,
                              "lat" : 9.301444243932575517419536481611430644989013671875
                            } ],
                            "direction" : "direction"
                          }, {
                            "departs_at" : "departs_at",
                            "distance" : 2,
                            "line" : "line",
                            "num_stops" : 2,
                            "turn" : "turn",
                            "type" : "basic",
                            "travel_time" : 7,
                            "directions" : "directions",
                            "arrives_at" : "arrives_at",
                            "road" : "road",
                            "departure_station" : "departure_station",
                            "id" : "id",
                            "arrival_station" : "arrival_station",
                            "coords" : [ {
                              "lng" : 3.61607674925191080461672754609026014804840087890625,
                              "lat" : 9.301444243932575517419536481611430644989013671875
                            }, {
                              "lng" : 3.61607674925191080461672754609026014804840087890625,
                              "lat" : 9.301444243932575517419536481611430644989013671875
                            } ],
                            "direction" : "direction"
                          } ],
                          "departure_time" : "2000-01-23T04:56:07.000+00:00"
                        },
                        "distance" : 6,
                        "travel_time" : 0,
                        "fares" : {
                          "breakdown" : [ {
                            "modes" : [ null, null ],
                            "tickets" : [ {
                              "price" : 5.63737665663332876420099637471139430999755859375,
                              "currency" : "currency",
                              "type" : "single"
                            }, {
                              "price" : 5.63737665663332876420099637471139430999755859375,
                              "currency" : "currency",
                              "type" : "single"
                            } ],
                            "route_part_ids" : [ 5, 5 ]
                          }, {
                            "modes" : [ null, null ],
                            "tickets" : [ {
                              "price" : 5.63737665663332876420099637471139430999755859375,
                              "currency" : "currency",
                              "type" : "single"
                            }, {
                              "price" : 5.63737665663332876420099637471139430999755859375,
                              "currency" : "currency",
                              "type" : "single"
                            } ],
                            "route_part_ids" : [ 5, 5 ]
                          } ],
                          "tickets_total" : [ {
                            "price" : 5.63737665663332876420099637471139430999755859375,
                            "currency" : "currency",
                            "type" : "single"
                          }, {
                            "price" : 5.63737665663332876420099637471139430999755859375,
                            "currency" : "currency",
                            "type" : "single"
                          } ]
                        }
                      }, {
                        "route" : {
                          "arrival_time" : "2000-01-23T04:56:07.000+00:00",
                          "parts" : [ {
                            "departs_at" : "departs_at",
                            "distance" : 2,
                            "line" : "line",
                            "num_stops" : 2,
                            "turn" : "turn",
                            "type" : "basic",
                            "travel_time" : 7,
                            "directions" : "directions",
                            "arrives_at" : "arrives_at",
                            "road" : "road",
                            "departure_station" : "departure_station",
                            "id" : "id",
                            "arrival_station" : "arrival_station",
                            "coords" : [ {
                              "lng" : 3.61607674925191080461672754609026014804840087890625,
                              "lat" : 9.301444243932575517419536481611430644989013671875
                            }, {
                              "lng" : 3.61607674925191080461672754609026014804840087890625,
                              "lat" : 9.301444243932575517419536481611430644989013671875
                            } ],
                            "direction" : "direction"
                          }, {
                            "departs_at" : "departs_at",
                            "distance" : 2,
                            "line" : "line",
                            "num_stops" : 2,
                            "turn" : "turn",
                            "type" : "basic",
                            "travel_time" : 7,
                            "directions" : "directions",
                            "arrives_at" : "arrives_at",
                            "road" : "road",
                            "departure_station" : "departure_station",
                            "id" : "id",
                            "arrival_station" : "arrival_station",
                            "coords" : [ {
                              "lng" : 3.61607674925191080461672754609026014804840087890625,
                              "lat" : 9.301444243932575517419536481611430644989013671875
                            }, {
                              "lng" : 3.61607674925191080461672754609026014804840087890625,
                              "lat" : 9.301444243932575517419536481611430644989013671875
                            } ],
                            "direction" : "direction"
                          } ],
                          "departure_time" : "2000-01-23T04:56:07.000+00:00"
                        },
                        "distance" : 6,
                        "travel_time" : 0,
                        "fares" : {
                          "breakdown" : [ {
                            "modes" : [ null, null ],
                            "tickets" : [ {
                              "price" : 5.63737665663332876420099637471139430999755859375,
                              "currency" : "currency",
                              "type" : "single"
                            }, {
                              "price" : 5.63737665663332876420099637471139430999755859375,
                              "currency" : "currency",
                              "type" : "single"
                            } ],
                            "route_part_ids" : [ 5, 5 ]
                          }, {
                            "modes" : [ null, null ],
                            "tickets" : [ {
                              "price" : 5.63737665663332876420099637471139430999755859375,
                              "currency" : "currency",
                              "type" : "single"
                            }, {
                              "price" : 5.63737665663332876420099637471139430999755859375,
                              "currency" : "currency",
                              "type" : "single"
                            } ],
                            "route_part_ids" : [ 5, 5 ]
                          } ],
                          "tickets_total" : [ {
                            "price" : 5.63737665663332876420099637471139430999755859375,
                            "currency" : "currency",
                            "type" : "single"
                          }, {
                            "price" : 5.63737665663332876420099637471139430999755859375,
                            "currency" : "currency",
                            "type" : "single"
                          } ]
                        }
                      } ]
                    }, {
                      "id" : "id",
                      "properties" : [ {
                        "route" : {
                          "arrival_time" : "2000-01-23T04:56:07.000+00:00",
                          "parts" : [ {
                            "departs_at" : "departs_at",
                            "distance" : 2,
                            "line" : "line",
                            "num_stops" : 2,
                            "turn" : "turn",
                            "type" : "basic",
                            "travel_time" : 7,
                            "directions" : "directions",
                            "arrives_at" : "arrives_at",
                            "road" : "road",
                            "departure_station" : "departure_station",
                            "id" : "id",
                            "arrival_station" : "arrival_station",
                            "coords" : [ {
                              "lng" : 3.61607674925191080461672754609026014804840087890625,
                              "lat" : 9.301444243932575517419536481611430644989013671875
                            }, {
                              "lng" : 3.61607674925191080461672754609026014804840087890625,
                              "lat" : 9.301444243932575517419536481611430644989013671875
                            } ],
                            "direction" : "direction"
                          }, {
                            "departs_at" : "departs_at",
                            "distance" : 2,
                            "line" : "line",
                            "num_stops" : 2,
                            "turn" : "turn",
                            "type" : "basic",
                            "travel_time" : 7,
                            "directions" : "directions",
                            "arrives_at" : "arrives_at",
                            "road" : "road",
                            "departure_station" : "departure_station",
                            "id" : "id",
                            "arrival_station" : "arrival_station",
                            "coords" : [ {
                              "lng" : 3.61607674925191080461672754609026014804840087890625,
                              "lat" : 9.301444243932575517419536481611430644989013671875
                            }, {
                              "lng" : 3.61607674925191080461672754609026014804840087890625,
                              "lat" : 9.301444243932575517419536481611430644989013671875
                            } ],
                            "direction" : "direction"
                          } ],
                          "departure_time" : "2000-01-23T04:56:07.000+00:00"
                        },
                        "distance" : 6,
                        "travel_time" : 0,
                        "fares" : {
                          "breakdown" : [ {
                            "modes" : [ null, null ],
                            "tickets" : [ {
                              "price" : 5.63737665663332876420099637471139430999755859375,
                              "currency" : "currency",
                              "type" : "single"
                            }, {
                              "price" : 5.63737665663332876420099637471139430999755859375,
                              "currency" : "currency",
                              "type" : "single"
                            } ],
                            "route_part_ids" : [ 5, 5 ]
                          }, {
                            "modes" : [ null, null ],
                            "tickets" : [ {
                              "price" : 5.63737665663332876420099637471139430999755859375,
                              "currency" : "currency",
                              "type" : "single"
                            }, {
                              "price" : 5.63737665663332876420099637471139430999755859375,
                              "currency" : "currency",
                              "type" : "single"
                            } ],
                            "route_part_ids" : [ 5, 5 ]
                          } ],
                          "tickets_total" : [ {
                            "price" : 5.63737665663332876420099637471139430999755859375,
                            "currency" : "currency",
                            "type" : "single"
                          }, {
                            "price" : 5.63737665663332876420099637471139430999755859375,
                            "currency" : "currency",
                            "type" : "single"
                          } ]
                        }
                      }, {
                        "route" : {
                          "arrival_time" : "2000-01-23T04:56:07.000+00:00",
                          "parts" : [ {
                            "departs_at" : "departs_at",
                            "distance" : 2,
                            "line" : "line",
                            "num_stops" : 2,
                            "turn" : "turn",
                            "type" : "basic",
                            "travel_time" : 7,
                            "directions" : "directions",
                            "arrives_at" : "arrives_at",
                            "road" : "road",
                            "departure_station" : "departure_station",
                            "id" : "id",
                            "arrival_station" : "arrival_station",
                            "coords" : [ {
                              "lng" : 3.61607674925191080461672754609026014804840087890625,
                              "lat" : 9.301444243932575517419536481611430644989013671875
                            }, {
                              "lng" : 3.61607674925191080461672754609026014804840087890625,
                              "lat" : 9.301444243932575517419536481611430644989013671875
                            } ],
                            "direction" : "direction"
                          }, {
                            "departs_at" : "departs_at",
                            "distance" : 2,
                            "line" : "line",
                            "num_stops" : 2,
                            "turn" : "turn",
                            "type" : "basic",
                            "travel_time" : 7,
                            "directions" : "directions",
                            "arrives_at" : "arrives_at",
                            "road" : "road",
                            "departure_station" : "departure_station",
                            "id" : "id",
                            "arrival_station" : "arrival_station",
                            "coords" : [ {
                              "lng" : 3.61607674925191080461672754609026014804840087890625,
                              "lat" : 9.301444243932575517419536481611430644989013671875
                            }, {
                              "lng" : 3.61607674925191080461672754609026014804840087890625,
                              "lat" : 9.301444243932575517419536481611430644989013671875
                            } ],
                            "direction" : "direction"
                          } ],
                          "departure_time" : "2000-01-23T04:56:07.000+00:00"
                        },
                        "distance" : 6,
                        "travel_time" : 0,
                        "fares" : {
                          "breakdown" : [ {
                            "modes" : [ null, null ],
                            "tickets" : [ {
                              "price" : 5.63737665663332876420099637471139430999755859375,
                              "currency" : "currency",
                              "type" : "single"
                            }, {
                              "price" : 5.63737665663332876420099637471139430999755859375,
                              "currency" : "currency",
                              "type" : "single"
                            } ],
                            "route_part_ids" : [ 5, 5 ]
                          }, {
                            "modes" : [ null, null ],
                            "tickets" : [ {
                              "price" : 5.63737665663332876420099637471139430999755859375,
                              "currency" : "currency",
                              "type" : "single"
                            }, {
                              "price" : 5.63737665663332876420099637471139430999755859375,
                              "currency" : "currency",
                              "type" : "single"
                            } ],
                            "route_part_ids" : [ 5, 5 ]
                          } ],
                          "tickets_total" : [ {
                            "price" : 5.63737665663332876420099637471139430999755859375,
                            "currency" : "currency",
                            "type" : "single"
                          }, {
                            "price" : 5.63737665663332876420099637471139430999755859375,
                            "currency" : "currency",
                            "type" : "single"
                          } ]
                        }
                      } ]
                    } ],
                    "search_id" : "search_id"
                  }, {
                    "unreachable" : [ "unreachable", "unreachable" ],
                    "locations" : [ {
                      "id" : "id",
                      "properties" : [ {
                        "route" : {
                          "arrival_time" : "2000-01-23T04:56:07.000+00:00",
                          "parts" : [ {
                            "departs_at" : "departs_at",
                            "distance" : 2,
                            "line" : "line",
                            "num_stops" : 2,
                            "turn" : "turn",
                            "type" : "basic",
                            "travel_time" : 7,
                            "directions" : "directions",
                            "arrives_at" : "arrives_at",
                            "road" : "road",
                            "departure_station" : "departure_station",
                            "id" : "id",
                            "arrival_station" : "arrival_station",
                            "coords" : [ {
                              "lng" : 3.61607674925191080461672754609026014804840087890625,
                              "lat" : 9.301444243932575517419536481611430644989013671875
                            }, {
                              "lng" : 3.61607674925191080461672754609026014804840087890625,
                              "lat" : 9.301444243932575517419536481611430644989013671875
                            } ],
                            "direction" : "direction"
                          }, {
                            "departs_at" : "departs_at",
                            "distance" : 2,
                            "line" : "line",
                            "num_stops" : 2,
                            "turn" : "turn",
                            "type" : "basic",
                            "travel_time" : 7,
                            "directions" : "directions",
                            "arrives_at" : "arrives_at",
                            "road" : "road",
                            "departure_station" : "departure_station",
                            "id" : "id",
                            "arrival_station" : "arrival_station",
                            "coords" : [ {
                              "lng" : 3.61607674925191080461672754609026014804840087890625,
                              "lat" : 9.301444243932575517419536481611430644989013671875
                            }, {
                              "lng" : 3.61607674925191080461672754609026014804840087890625,
                              "lat" : 9.301444243932575517419536481611430644989013671875
                            } ],
                            "direction" : "direction"
                          } ],
                          "departure_time" : "2000-01-23T04:56:07.000+00:00"
                        },
                        "distance" : 6,
                        "travel_time" : 0,
                        "fares" : {
                          "breakdown" : [ {
                            "modes" : [ null, null ],
                            "tickets" : [ {
                              "price" : 5.63737665663332876420099637471139430999755859375,
                              "currency" : "currency",
                              "type" : "single"
                            }, {
                              "price" : 5.63737665663332876420099637471139430999755859375,
                              "currency" : "currency",
                              "type" : "single"
                            } ],
                            "route_part_ids" : [ 5, 5 ]
                          }, {
                            "modes" : [ null, null ],
                            "tickets" : [ {
                              "price" : 5.63737665663332876420099637471139430999755859375,
                              "currency" : "currency",
                              "type" : "single"
                            }, {
                              "price" : 5.63737665663332876420099637471139430999755859375,
                              "currency" : "currency",
                              "type" : "single"
                            } ],
                            "route_part_ids" : [ 5, 5 ]
                          } ],
                          "tickets_total" : [ {
                            "price" : 5.63737665663332876420099637471139430999755859375,
                            "currency" : "currency",
                            "type" : "single"
                          }, {
                            "price" : 5.63737665663332876420099637471139430999755859375,
                            "currency" : "currency",
                            "type" : "single"
                          } ]
                        }
                      }, {
                        "route" : {
                          "arrival_time" : "2000-01-23T04:56:07.000+00:00",
                          "parts" : [ {
                            "departs_at" : "departs_at",
                            "distance" : 2,
                            "line" : "line",
                            "num_stops" : 2,
                            "turn" : "turn",
                            "type" : "basic",
                            "travel_time" : 7,
                            "directions" : "directions",
                            "arrives_at" : "arrives_at",
                            "road" : "road",
                            "departure_station" : "departure_station",
                            "id" : "id",
                            "arrival_station" : "arrival_station",
                            "coords" : [ {
                              "lng" : 3.61607674925191080461672754609026014804840087890625,
                              "lat" : 9.301444243932575517419536481611430644989013671875
                            }, {
                              "lng" : 3.61607674925191080461672754609026014804840087890625,
                              "lat" : 9.301444243932575517419536481611430644989013671875
                            } ],
                            "direction" : "direction"
                          }, {
                            "departs_at" : "departs_at",
                            "distance" : 2,
                            "line" : "line",
                            "num_stops" : 2,
                            "turn" : "turn",
                            "type" : "basic",
                            "travel_time" : 7,
                            "directions" : "directions",
                            "arrives_at" : "arrives_at",
                            "road" : "road",
                            "departure_station" : "departure_station",
                            "id" : "id",
                            "arrival_station" : "arrival_station",
                            "coords" : [ {
                              "lng" : 3.61607674925191080461672754609026014804840087890625,
                              "lat" : 9.301444243932575517419536481611430644989013671875
                            }, {
                              "lng" : 3.61607674925191080461672754609026014804840087890625,
                              "lat" : 9.301444243932575517419536481611430644989013671875
                            } ],
                            "direction" : "direction"
                          } ],
                          "departure_time" : "2000-01-23T04:56:07.000+00:00"
                        },
                        "distance" : 6,
                        "travel_time" : 0,
                        "fares" : {
                          "breakdown" : [ {
                            "modes" : [ null, null ],
                            "tickets" : [ {
                              "price" : 5.63737665663332876420099637471139430999755859375,
                              "currency" : "currency",
                              "type" : "single"
                            }, {
                              "price" : 5.63737665663332876420099637471139430999755859375,
                              "currency" : "currency",
                              "type" : "single"
                            } ],
                            "route_part_ids" : [ 5, 5 ]
                          }, {
                            "modes" : [ null, null ],
                            "tickets" : [ {
                              "price" : 5.63737665663332876420099637471139430999755859375,
                              "currency" : "currency",
                              "type" : "single"
                            }, {
                              "price" : 5.63737665663332876420099637471139430999755859375,
                              "currency" : "currency",
                              "type" : "single"
                            } ],
                            "route_part_ids" : [ 5, 5 ]
                          } ],
                          "tickets_total" : [ {
                            "price" : 5.63737665663332876420099637471139430999755859375,
                            "currency" : "currency",
                            "type" : "single"
                          }, {
                            "price" : 5.63737665663332876420099637471139430999755859375,
                            "currency" : "currency",
                            "type" : "single"
                          } ]
                        }
                      } ]
                    }, {
                      "id" : "id",
                      "properties" : [ {
                        "route" : {
                          "arrival_time" : "2000-01-23T04:56:07.000+00:00",
                          "parts" : [ {
                            "departs_at" : "departs_at",
                            "distance" : 2,
                            "line" : "line",
                            "num_stops" : 2,
                            "turn" : "turn",
                            "type" : "basic",
                            "travel_time" : 7,
                            "directions" : "directions",
                            "arrives_at" : "arrives_at",
                            "road" : "road",
                            "departure_station" : "departure_station",
                            "id" : "id",
                            "arrival_station" : "arrival_station",
                            "coords" : [ {
                              "lng" : 3.61607674925191080461672754609026014804840087890625,
                              "lat" : 9.301444243932575517419536481611430644989013671875
                            }, {
                              "lng" : 3.61607674925191080461672754609026014804840087890625,
                              "lat" : 9.301444243932575517419536481611430644989013671875
                            } ],
                            "direction" : "direction"
                          }, {
                            "departs_at" : "departs_at",
                            "distance" : 2,
                            "line" : "line",
                            "num_stops" : 2,
                            "turn" : "turn",
                            "type" : "basic",
                            "travel_time" : 7,
                            "directions" : "directions",
                            "arrives_at" : "arrives_at",
                            "road" : "road",
                            "departure_station" : "departure_station",
                            "id" : "id",
                            "arrival_station" : "arrival_station",
                            "coords" : [ {
                              "lng" : 3.61607674925191080461672754609026014804840087890625,
                              "lat" : 9.301444243932575517419536481611430644989013671875
                            }, {
                              "lng" : 3.61607674925191080461672754609026014804840087890625,
                              "lat" : 9.301444243932575517419536481611430644989013671875
                            } ],
                            "direction" : "direction"
                          } ],
                          "departure_time" : "2000-01-23T04:56:07.000+00:00"
                        },
                        "distance" : 6,
                        "travel_time" : 0,
                        "fares" : {
                          "breakdown" : [ {
                            "modes" : [ null, null ],
                            "tickets" : [ {
                              "price" : 5.63737665663332876420099637471139430999755859375,
                              "currency" : "currency",
                              "type" : "single"
                            }, {
                              "price" : 5.63737665663332876420099637471139430999755859375,
                              "currency" : "currency",
                              "type" : "single"
                            } ],
                            "route_part_ids" : [ 5, 5 ]
                          }, {
                            "modes" : [ null, null ],
                            "tickets" : [ {
                              "price" : 5.63737665663332876420099637471139430999755859375,
                              "currency" : "currency",
                              "type" : "single"
                            }, {
                              "price" : 5.63737665663332876420099637471139430999755859375,
                              "currency" : "currency",
                              "type" : "single"
                            } ],
                            "route_part_ids" : [ 5, 5 ]
                          } ],
                          "tickets_total" : [ {
                            "price" : 5.63737665663332876420099637471139430999755859375,
                            "currency" : "currency",
                            "type" : "single"
                          }, {
                            "price" : 5.63737665663332876420099637471139430999755859375,
                            "currency" : "currency",
                            "type" : "single"
                          } ]
                        }
                      }, {
                        "route" : {
                          "arrival_time" : "2000-01-23T04:56:07.000+00:00",
                          "parts" : [ {
                            "departs_at" : "departs_at",
                            "distance" : 2,
                            "line" : "line",
                            "num_stops" : 2,
                            "turn" : "turn",
                            "type" : "basic",
                            "travel_time" : 7,
                            "directions" : "directions",
                            "arrives_at" : "arrives_at",
                            "road" : "road",
                            "departure_station" : "departure_station",
                            "id" : "id",
                            "arrival_station" : "arrival_station",
                            "coords" : [ {
                              "lng" : 3.61607674925191080461672754609026014804840087890625,
                              "lat" : 9.301444243932575517419536481611430644989013671875
                            }, {
                              "lng" : 3.61607674925191080461672754609026014804840087890625,
                              "lat" : 9.301444243932575517419536481611430644989013671875
                            } ],
                            "direction" : "direction"
                          }, {
                            "departs_at" : "departs_at",
                            "distance" : 2,
                            "line" : "line",
                            "num_stops" : 2,
                            "turn" : "turn",
                            "type" : "basic",
                            "travel_time" : 7,
                            "directions" : "directions",
                            "arrives_at" : "arrives_at",
                            "road" : "road",
                            "departure_station" : "departure_station",
                            "id" : "id",
                            "arrival_station" : "arrival_station",
                            "coords" : [ {
                              "lng" : 3.61607674925191080461672754609026014804840087890625,
                              "lat" : 9.301444243932575517419536481611430644989013671875
                            }, {
                              "lng" : 3.61607674925191080461672754609026014804840087890625,
                              "lat" : 9.301444243932575517419536481611430644989013671875
                            } ],
                            "direction" : "direction"
                          } ],
                          "departure_time" : "2000-01-23T04:56:07.000+00:00"
                        },
                        "distance" : 6,
                        "travel_time" : 0,
                        "fares" : {
                          "breakdown" : [ {
                            "modes" : [ null, null ],
                            "tickets" : [ {
                              "price" : 5.63737665663332876420099637471139430999755859375,
                              "currency" : "currency",
                              "type" : "single"
                            }, {
                              "price" : 5.63737665663332876420099637471139430999755859375,
                              "currency" : "currency",
                              "type" : "single"
                            } ],
                            "route_part_ids" : [ 5, 5 ]
                          }, {
                            "modes" : [ null, null ],
                            "tickets" : [ {
                              "price" : 5.63737665663332876420099637471139430999755859375,
                              "currency" : "currency",
                              "type" : "single"
                            }, {
                              "price" : 5.63737665663332876420099637471139430999755859375,
                              "currency" : "currency",
                              "type" : "single"
                            } ],
                            "route_part_ids" : [ 5, 5 ]
                          } ],
                          "tickets_total" : [ {
                            "price" : 5.63737665663332876420099637471139430999755859375,
                            "currency" : "currency",
                            "type" : "single"
                          }, {
                            "price" : 5.63737665663332876420099637471139430999755859375,
                            "currency" : "currency",
                            "type" : "single"
                          } ]
                        }
                      } ]
                    } ],
                    "search_id" : "search_id"
                  } ]
                }"""
                
                when(exampleContentType) {
                    "application/json" -> call.respond(gson.fromJson(exampleContentString, empty::class.java))
                    "application/xml" -> call.respondText(exampleContentString, ContentType.Text.Xml)
                    else -> call.respondText(exampleContentString)
                }
            }
        }
    }
    .apply {
      // TODO: ktor doesn't allow different authentication registrations for endpoints sharing the same path but different methods.
      //       It could be the authentication block is being abused here. Until this is resolved, swallow duplicate exceptions.

        try {
            authentication {
                // "Implement API key auth (ApiKey) for parameter name 'X-Api-Key'."
                apiKeyAuth("X-Api-Key", "header") {
                    // TODO: "Verify key here , accessible as it.value"
                    if (it.value == "keyboardcat") {
                         ApiPrincipal(it)
                    } else {
                        null
                    }
                }
                // "Implement API key auth (ApplicationId) for parameter name 'X-Application-Id'."
                apiKeyAuth("X-Application-Id", "header") {
                    // TODO: "Verify key here , accessible as it.value"
                    if (it.value == "keyboardcat") {
                         ApiPrincipal(it)
                    } else {
                        null
                    }
                }
            }
        } catch(e: io.ktor.application.DuplicateApplicationFeatureException){
            application.environment.log.warn("authentication block for '/v4/routes' is duplicated in code. " +
            "Generated endpoints may need to be merged under a 'route' entry.")
        }
    }

    route("/v4/supported-locations") {
        post {
            val principal = call.authentication.principal<ApiPrincipal>()
            val principal = call.authentication.principal<ApiPrincipal>()
            
            if (principal == null) {
                call.respond(HttpStatusCode.Unauthorized)
            } else {
                val exampleContentType = "application/json"
                val exampleContentString = """{
                  "unsupported_locations" : [ "unsupported_locations", "unsupported_locations" ],
                  "locations" : [ {
                    "map_name" : "map_name",
                    "id" : "id"
                  }, {
                    "map_name" : "map_name",
                    "id" : "id"
                  } ]
                }"""
                
                when(exampleContentType) {
                    "application/json" -> call.respond(gson.fromJson(exampleContentString, empty::class.java))
                    "application/xml" -> call.respondText(exampleContentString, ContentType.Text.Xml)
                    else -> call.respondText(exampleContentString)
                }
            }
        }
    }
    .apply {
      // TODO: ktor doesn't allow different authentication registrations for endpoints sharing the same path but different methods.
      //       It could be the authentication block is being abused here. Until this is resolved, swallow duplicate exceptions.

        try {
            authentication {
                // "Implement API key auth (ApiKey) for parameter name 'X-Api-Key'."
                apiKeyAuth("X-Api-Key", "header") {
                    // TODO: "Verify key here , accessible as it.value"
                    if (it.value == "keyboardcat") {
                         ApiPrincipal(it)
                    } else {
                        null
                    }
                }
                // "Implement API key auth (ApplicationId) for parameter name 'X-Application-Id'."
                apiKeyAuth("X-Application-Id", "header") {
                    // TODO: "Verify key here , accessible as it.value"
                    if (it.value == "keyboardcat") {
                         ApiPrincipal(it)
                    } else {
                        null
                    }
                }
            }
        } catch(e: io.ktor.application.DuplicateApplicationFeatureException){
            application.environment.log.warn("authentication block for '/v4/supported-locations' is duplicated in code. " +
            "Generated endpoints may need to be merged under a 'route' entry.")
        }
    }

    route("/v4/time-filter") {
        post {
            val principal = call.authentication.principal<ApiPrincipal>()
            val principal = call.authentication.principal<ApiPrincipal>()
            
            if (principal == null) {
                call.respond(HttpStatusCode.Unauthorized)
            } else {
                val exampleContentType = "application/json"
                val exampleContentString = """{
                  "results" : [ {
                    "unreachable" : [ "unreachable", "unreachable" ],
                    "locations" : [ {
                      "id" : "id",
                      "properties" : [ {
                        "distance_breakdown" : [ {
                          "distance" : 1
                        }, {
                          "distance" : 1
                        } ],
                        "route" : {
                          "arrival_time" : "2000-01-23T04:56:07.000+00:00",
                          "parts" : [ {
                            "departs_at" : "departs_at",
                            "distance" : 2,
                            "line" : "line",
                            "num_stops" : 2,
                            "turn" : "turn",
                            "type" : "basic",
                            "travel_time" : 7,
                            "directions" : "directions",
                            "arrives_at" : "arrives_at",
                            "road" : "road",
                            "departure_station" : "departure_station",
                            "id" : "id",
                            "arrival_station" : "arrival_station",
                            "coords" : [ {
                              "lng" : 3.61607674925191080461672754609026014804840087890625,
                              "lat" : 9.301444243932575517419536481611430644989013671875
                            }, {
                              "lng" : 3.61607674925191080461672754609026014804840087890625,
                              "lat" : 9.301444243932575517419536481611430644989013671875
                            } ],
                            "direction" : "direction"
                          }, {
                            "departs_at" : "departs_at",
                            "distance" : 2,
                            "line" : "line",
                            "num_stops" : 2,
                            "turn" : "turn",
                            "type" : "basic",
                            "travel_time" : 7,
                            "directions" : "directions",
                            "arrives_at" : "arrives_at",
                            "road" : "road",
                            "departure_station" : "departure_station",
                            "id" : "id",
                            "arrival_station" : "arrival_station",
                            "coords" : [ {
                              "lng" : 3.61607674925191080461672754609026014804840087890625,
                              "lat" : 9.301444243932575517419536481611430644989013671875
                            }, {
                              "lng" : 3.61607674925191080461672754609026014804840087890625,
                              "lat" : 9.301444243932575517419536481611430644989013671875
                            } ],
                            "direction" : "direction"
                          } ],
                          "departure_time" : "2000-01-23T04:56:07.000+00:00"
                        },
                        "distance" : 6,
                        "travel_time" : 0,
                        "fares" : {
                          "breakdown" : [ {
                            "modes" : [ null, null ],
                            "tickets" : [ {
                              "price" : 5.63737665663332876420099637471139430999755859375,
                              "currency" : "currency",
                              "type" : "single"
                            }, {
                              "price" : 5.63737665663332876420099637471139430999755859375,
                              "currency" : "currency",
                              "type" : "single"
                            } ],
                            "route_part_ids" : [ 5, 5 ]
                          }, {
                            "modes" : [ null, null ],
                            "tickets" : [ {
                              "price" : 5.63737665663332876420099637471139430999755859375,
                              "currency" : "currency",
                              "type" : "single"
                            }, {
                              "price" : 5.63737665663332876420099637471139430999755859375,
                              "currency" : "currency",
                              "type" : "single"
                            } ],
                            "route_part_ids" : [ 5, 5 ]
                          } ],
                          "tickets_total" : [ {
                            "price" : 5.63737665663332876420099637471139430999755859375,
                            "currency" : "currency",
                            "type" : "single"
                          }, {
                            "price" : 5.63737665663332876420099637471139430999755859375,
                            "currency" : "currency",
                            "type" : "single"
                          } ]
                        }
                      }, {
                        "distance_breakdown" : [ {
                          "distance" : 1
                        }, {
                          "distance" : 1
                        } ],
                        "route" : {
                          "arrival_time" : "2000-01-23T04:56:07.000+00:00",
                          "parts" : [ {
                            "departs_at" : "departs_at",
                            "distance" : 2,
                            "line" : "line",
                            "num_stops" : 2,
                            "turn" : "turn",
                            "type" : "basic",
                            "travel_time" : 7,
                            "directions" : "directions",
                            "arrives_at" : "arrives_at",
                            "road" : "road",
                            "departure_station" : "departure_station",
                            "id" : "id",
                            "arrival_station" : "arrival_station",
                            "coords" : [ {
                              "lng" : 3.61607674925191080461672754609026014804840087890625,
                              "lat" : 9.301444243932575517419536481611430644989013671875
                            }, {
                              "lng" : 3.61607674925191080461672754609026014804840087890625,
                              "lat" : 9.301444243932575517419536481611430644989013671875
                            } ],
                            "direction" : "direction"
                          }, {
                            "departs_at" : "departs_at",
                            "distance" : 2,
                            "line" : "line",
                            "num_stops" : 2,
                            "turn" : "turn",
                            "type" : "basic",
                            "travel_time" : 7,
                            "directions" : "directions",
                            "arrives_at" : "arrives_at",
                            "road" : "road",
                            "departure_station" : "departure_station",
                            "id" : "id",
                            "arrival_station" : "arrival_station",
                            "coords" : [ {
                              "lng" : 3.61607674925191080461672754609026014804840087890625,
                              "lat" : 9.301444243932575517419536481611430644989013671875
                            }, {
                              "lng" : 3.61607674925191080461672754609026014804840087890625,
                              "lat" : 9.301444243932575517419536481611430644989013671875
                            } ],
                            "direction" : "direction"
                          } ],
                          "departure_time" : "2000-01-23T04:56:07.000+00:00"
                        },
                        "distance" : 6,
                        "travel_time" : 0,
                        "fares" : {
                          "breakdown" : [ {
                            "modes" : [ null, null ],
                            "tickets" : [ {
                              "price" : 5.63737665663332876420099637471139430999755859375,
                              "currency" : "currency",
                              "type" : "single"
                            }, {
                              "price" : 5.63737665663332876420099637471139430999755859375,
                              "currency" : "currency",
                              "type" : "single"
                            } ],
                            "route_part_ids" : [ 5, 5 ]
                          }, {
                            "modes" : [ null, null ],
                            "tickets" : [ {
                              "price" : 5.63737665663332876420099637471139430999755859375,
                              "currency" : "currency",
                              "type" : "single"
                            }, {
                              "price" : 5.63737665663332876420099637471139430999755859375,
                              "currency" : "currency",
                              "type" : "single"
                            } ],
                            "route_part_ids" : [ 5, 5 ]
                          } ],
                          "tickets_total" : [ {
                            "price" : 5.63737665663332876420099637471139430999755859375,
                            "currency" : "currency",
                            "type" : "single"
                          }, {
                            "price" : 5.63737665663332876420099637471139430999755859375,
                            "currency" : "currency",
                            "type" : "single"
                          } ]
                        }
                      } ]
                    }, {
                      "id" : "id",
                      "properties" : [ {
                        "distance_breakdown" : [ {
                          "distance" : 1
                        }, {
                          "distance" : 1
                        } ],
                        "route" : {
                          "arrival_time" : "2000-01-23T04:56:07.000+00:00",
                          "parts" : [ {
                            "departs_at" : "departs_at",
                            "distance" : 2,
                            "line" : "line",
                            "num_stops" : 2,
                            "turn" : "turn",
                            "type" : "basic",
                            "travel_time" : 7,
                            "directions" : "directions",
                            "arrives_at" : "arrives_at",
                            "road" : "road",
                            "departure_station" : "departure_station",
                            "id" : "id",
                            "arrival_station" : "arrival_station",
                            "coords" : [ {
                              "lng" : 3.61607674925191080461672754609026014804840087890625,
                              "lat" : 9.301444243932575517419536481611430644989013671875
                            }, {
                              "lng" : 3.61607674925191080461672754609026014804840087890625,
                              "lat" : 9.301444243932575517419536481611430644989013671875
                            } ],
                            "direction" : "direction"
                          }, {
                            "departs_at" : "departs_at",
                            "distance" : 2,
                            "line" : "line",
                            "num_stops" : 2,
                            "turn" : "turn",
                            "type" : "basic",
                            "travel_time" : 7,
                            "directions" : "directions",
                            "arrives_at" : "arrives_at",
                            "road" : "road",
                            "departure_station" : "departure_station",
                            "id" : "id",
                            "arrival_station" : "arrival_station",
                            "coords" : [ {
                              "lng" : 3.61607674925191080461672754609026014804840087890625,
                              "lat" : 9.301444243932575517419536481611430644989013671875
                            }, {
                              "lng" : 3.61607674925191080461672754609026014804840087890625,
                              "lat" : 9.301444243932575517419536481611430644989013671875
                            } ],
                            "direction" : "direction"
                          } ],
                          "departure_time" : "2000-01-23T04:56:07.000+00:00"
                        },
                        "distance" : 6,
                        "travel_time" : 0,
                        "fares" : {
                          "breakdown" : [ {
                            "modes" : [ null, null ],
                            "tickets" : [ {
                              "price" : 5.63737665663332876420099637471139430999755859375,
                              "currency" : "currency",
                              "type" : "single"
                            }, {
                              "price" : 5.63737665663332876420099637471139430999755859375,
                              "currency" : "currency",
                              "type" : "single"
                            } ],
                            "route_part_ids" : [ 5, 5 ]
                          }, {
                            "modes" : [ null, null ],
                            "tickets" : [ {
                              "price" : 5.63737665663332876420099637471139430999755859375,
                              "currency" : "currency",
                              "type" : "single"
                            }, {
                              "price" : 5.63737665663332876420099637471139430999755859375,
                              "currency" : "currency",
                              "type" : "single"
                            } ],
                            "route_part_ids" : [ 5, 5 ]
                          } ],
                          "tickets_total" : [ {
                            "price" : 5.63737665663332876420099637471139430999755859375,
                            "currency" : "currency",
                            "type" : "single"
                          }, {
                            "price" : 5.63737665663332876420099637471139430999755859375,
                            "currency" : "currency",
                            "type" : "single"
                          } ]
                        }
                      }, {
                        "distance_breakdown" : [ {
                          "distance" : 1
                        }, {
                          "distance" : 1
                        } ],
                        "route" : {
                          "arrival_time" : "2000-01-23T04:56:07.000+00:00",
                          "parts" : [ {
                            "departs_at" : "departs_at",
                            "distance" : 2,
                            "line" : "line",
                            "num_stops" : 2,
                            "turn" : "turn",
                            "type" : "basic",
                            "travel_time" : 7,
                            "directions" : "directions",
                            "arrives_at" : "arrives_at",
                            "road" : "road",
                            "departure_station" : "departure_station",
                            "id" : "id",
                            "arrival_station" : "arrival_station",
                            "coords" : [ {
                              "lng" : 3.61607674925191080461672754609026014804840087890625,
                              "lat" : 9.301444243932575517419536481611430644989013671875
                            }, {
                              "lng" : 3.61607674925191080461672754609026014804840087890625,
                              "lat" : 9.301444243932575517419536481611430644989013671875
                            } ],
                            "direction" : "direction"
                          }, {
                            "departs_at" : "departs_at",
                            "distance" : 2,
                            "line" : "line",
                            "num_stops" : 2,
                            "turn" : "turn",
                            "type" : "basic",
                            "travel_time" : 7,
                            "directions" : "directions",
                            "arrives_at" : "arrives_at",
                            "road" : "road",
                            "departure_station" : "departure_station",
                            "id" : "id",
                            "arrival_station" : "arrival_station",
                            "coords" : [ {
                              "lng" : 3.61607674925191080461672754609026014804840087890625,
                              "lat" : 9.301444243932575517419536481611430644989013671875
                            }, {
                              "lng" : 3.61607674925191080461672754609026014804840087890625,
                              "lat" : 9.301444243932575517419536481611430644989013671875
                            } ],
                            "direction" : "direction"
                          } ],
                          "departure_time" : "2000-01-23T04:56:07.000+00:00"
                        },
                        "distance" : 6,
                        "travel_time" : 0,
                        "fares" : {
                          "breakdown" : [ {
                            "modes" : [ null, null ],
                            "tickets" : [ {
                              "price" : 5.63737665663332876420099637471139430999755859375,
                              "currency" : "currency",
                              "type" : "single"
                            }, {
                              "price" : 5.63737665663332876420099637471139430999755859375,
                              "currency" : "currency",
                              "type" : "single"
                            } ],
                            "route_part_ids" : [ 5, 5 ]
                          }, {
                            "modes" : [ null, null ],
                            "tickets" : [ {
                              "price" : 5.63737665663332876420099637471139430999755859375,
                              "currency" : "currency",
                              "type" : "single"
                            }, {
                              "price" : 5.63737665663332876420099637471139430999755859375,
                              "currency" : "currency",
                              "type" : "single"
                            } ],
                            "route_part_ids" : [ 5, 5 ]
                          } ],
                          "tickets_total" : [ {
                            "price" : 5.63737665663332876420099637471139430999755859375,
                            "currency" : "currency",
                            "type" : "single"
                          }, {
                            "price" : 5.63737665663332876420099637471139430999755859375,
                            "currency" : "currency",
                            "type" : "single"
                          } ]
                        }
                      } ]
                    } ],
                    "search_id" : "search_id"
                  }, {
                    "unreachable" : [ "unreachable", "unreachable" ],
                    "locations" : [ {
                      "id" : "id",
                      "properties" : [ {
                        "distance_breakdown" : [ {
                          "distance" : 1
                        }, {
                          "distance" : 1
                        } ],
                        "route" : {
                          "arrival_time" : "2000-01-23T04:56:07.000+00:00",
                          "parts" : [ {
                            "departs_at" : "departs_at",
                            "distance" : 2,
                            "line" : "line",
                            "num_stops" : 2,
                            "turn" : "turn",
                            "type" : "basic",
                            "travel_time" : 7,
                            "directions" : "directions",
                            "arrives_at" : "arrives_at",
                            "road" : "road",
                            "departure_station" : "departure_station",
                            "id" : "id",
                            "arrival_station" : "arrival_station",
                            "coords" : [ {
                              "lng" : 3.61607674925191080461672754609026014804840087890625,
                              "lat" : 9.301444243932575517419536481611430644989013671875
                            }, {
                              "lng" : 3.61607674925191080461672754609026014804840087890625,
                              "lat" : 9.301444243932575517419536481611430644989013671875
                            } ],
                            "direction" : "direction"
                          }, {
                            "departs_at" : "departs_at",
                            "distance" : 2,
                            "line" : "line",
                            "num_stops" : 2,
                            "turn" : "turn",
                            "type" : "basic",
                            "travel_time" : 7,
                            "directions" : "directions",
                            "arrives_at" : "arrives_at",
                            "road" : "road",
                            "departure_station" : "departure_station",
                            "id" : "id",
                            "arrival_station" : "arrival_station",
                            "coords" : [ {
                              "lng" : 3.61607674925191080461672754609026014804840087890625,
                              "lat" : 9.301444243932575517419536481611430644989013671875
                            }, {
                              "lng" : 3.61607674925191080461672754609026014804840087890625,
                              "lat" : 9.301444243932575517419536481611430644989013671875
                            } ],
                            "direction" : "direction"
                          } ],
                          "departure_time" : "2000-01-23T04:56:07.000+00:00"
                        },
                        "distance" : 6,
                        "travel_time" : 0,
                        "fares" : {
                          "breakdown" : [ {
                            "modes" : [ null, null ],
                            "tickets" : [ {
                              "price" : 5.63737665663332876420099637471139430999755859375,
                              "currency" : "currency",
                              "type" : "single"
                            }, {
                              "price" : 5.63737665663332876420099637471139430999755859375,
                              "currency" : "currency",
                              "type" : "single"
                            } ],
                            "route_part_ids" : [ 5, 5 ]
                          }, {
                            "modes" : [ null, null ],
                            "tickets" : [ {
                              "price" : 5.63737665663332876420099637471139430999755859375,
                              "currency" : "currency",
                              "type" : "single"
                            }, {
                              "price" : 5.63737665663332876420099637471139430999755859375,
                              "currency" : "currency",
                              "type" : "single"
                            } ],
                            "route_part_ids" : [ 5, 5 ]
                          } ],
                          "tickets_total" : [ {
                            "price" : 5.63737665663332876420099637471139430999755859375,
                            "currency" : "currency",
                            "type" : "single"
                          }, {
                            "price" : 5.63737665663332876420099637471139430999755859375,
                            "currency" : "currency",
                            "type" : "single"
                          } ]
                        }
                      }, {
                        "distance_breakdown" : [ {
                          "distance" : 1
                        }, {
                          "distance" : 1
                        } ],
                        "route" : {
                          "arrival_time" : "2000-01-23T04:56:07.000+00:00",
                          "parts" : [ {
                            "departs_at" : "departs_at",
                            "distance" : 2,
                            "line" : "line",
                            "num_stops" : 2,
                            "turn" : "turn",
                            "type" : "basic",
                            "travel_time" : 7,
                            "directions" : "directions",
                            "arrives_at" : "arrives_at",
                            "road" : "road",
                            "departure_station" : "departure_station",
                            "id" : "id",
                            "arrival_station" : "arrival_station",
                            "coords" : [ {
                              "lng" : 3.61607674925191080461672754609026014804840087890625,
                              "lat" : 9.301444243932575517419536481611430644989013671875
                            }, {
                              "lng" : 3.61607674925191080461672754609026014804840087890625,
                              "lat" : 9.301444243932575517419536481611430644989013671875
                            } ],
                            "direction" : "direction"
                          }, {
                            "departs_at" : "departs_at",
                            "distance" : 2,
                            "line" : "line",
                            "num_stops" : 2,
                            "turn" : "turn",
                            "type" : "basic",
                            "travel_time" : 7,
                            "directions" : "directions",
                            "arrives_at" : "arrives_at",
                            "road" : "road",
                            "departure_station" : "departure_station",
                            "id" : "id",
                            "arrival_station" : "arrival_station",
                            "coords" : [ {
                              "lng" : 3.61607674925191080461672754609026014804840087890625,
                              "lat" : 9.301444243932575517419536481611430644989013671875
                            }, {
                              "lng" : 3.61607674925191080461672754609026014804840087890625,
                              "lat" : 9.301444243932575517419536481611430644989013671875
                            } ],
                            "direction" : "direction"
                          } ],
                          "departure_time" : "2000-01-23T04:56:07.000+00:00"
                        },
                        "distance" : 6,
                        "travel_time" : 0,
                        "fares" : {
                          "breakdown" : [ {
                            "modes" : [ null, null ],
                            "tickets" : [ {
                              "price" : 5.63737665663332876420099637471139430999755859375,
                              "currency" : "currency",
                              "type" : "single"
                            }, {
                              "price" : 5.63737665663332876420099637471139430999755859375,
                              "currency" : "currency",
                              "type" : "single"
                            } ],
                            "route_part_ids" : [ 5, 5 ]
                          }, {
                            "modes" : [ null, null ],
                            "tickets" : [ {
                              "price" : 5.63737665663332876420099637471139430999755859375,
                              "currency" : "currency",
                              "type" : "single"
                            }, {
                              "price" : 5.63737665663332876420099637471139430999755859375,
                              "currency" : "currency",
                              "type" : "single"
                            } ],
                            "route_part_ids" : [ 5, 5 ]
                          } ],
                          "tickets_total" : [ {
                            "price" : 5.63737665663332876420099637471139430999755859375,
                            "currency" : "currency",
                            "type" : "single"
                          }, {
                            "price" : 5.63737665663332876420099637471139430999755859375,
                            "currency" : "currency",
                            "type" : "single"
                          } ]
                        }
                      } ]
                    }, {
                      "id" : "id",
                      "properties" : [ {
                        "distance_breakdown" : [ {
                          "distance" : 1
                        }, {
                          "distance" : 1
                        } ],
                        "route" : {
                          "arrival_time" : "2000-01-23T04:56:07.000+00:00",
                          "parts" : [ {
                            "departs_at" : "departs_at",
                            "distance" : 2,
                            "line" : "line",
                            "num_stops" : 2,
                            "turn" : "turn",
                            "type" : "basic",
                            "travel_time" : 7,
                            "directions" : "directions",
                            "arrives_at" : "arrives_at",
                            "road" : "road",
                            "departure_station" : "departure_station",
                            "id" : "id",
                            "arrival_station" : "arrival_station",
                            "coords" : [ {
                              "lng" : 3.61607674925191080461672754609026014804840087890625,
                              "lat" : 9.301444243932575517419536481611430644989013671875
                            }, {
                              "lng" : 3.61607674925191080461672754609026014804840087890625,
                              "lat" : 9.301444243932575517419536481611430644989013671875
                            } ],
                            "direction" : "direction"
                          }, {
                            "departs_at" : "departs_at",
                            "distance" : 2,
                            "line" : "line",
                            "num_stops" : 2,
                            "turn" : "turn",
                            "type" : "basic",
                            "travel_time" : 7,
                            "directions" : "directions",
                            "arrives_at" : "arrives_at",
                            "road" : "road",
                            "departure_station" : "departure_station",
                            "id" : "id",
                            "arrival_station" : "arrival_station",
                            "coords" : [ {
                              "lng" : 3.61607674925191080461672754609026014804840087890625,
                              "lat" : 9.301444243932575517419536481611430644989013671875
                            }, {
                              "lng" : 3.61607674925191080461672754609026014804840087890625,
                              "lat" : 9.301444243932575517419536481611430644989013671875
                            } ],
                            "direction" : "direction"
                          } ],
                          "departure_time" : "2000-01-23T04:56:07.000+00:00"
                        },
                        "distance" : 6,
                        "travel_time" : 0,
                        "fares" : {
                          "breakdown" : [ {
                            "modes" : [ null, null ],
                            "tickets" : [ {
                              "price" : 5.63737665663332876420099637471139430999755859375,
                              "currency" : "currency",
                              "type" : "single"
                            }, {
                              "price" : 5.63737665663332876420099637471139430999755859375,
                              "currency" : "currency",
                              "type" : "single"
                            } ],
                            "route_part_ids" : [ 5, 5 ]
                          }, {
                            "modes" : [ null, null ],
                            "tickets" : [ {
                              "price" : 5.63737665663332876420099637471139430999755859375,
                              "currency" : "currency",
                              "type" : "single"
                            }, {
                              "price" : 5.63737665663332876420099637471139430999755859375,
                              "currency" : "currency",
                              "type" : "single"
                            } ],
                            "route_part_ids" : [ 5, 5 ]
                          } ],
                          "tickets_total" : [ {
                            "price" : 5.63737665663332876420099637471139430999755859375,
                            "currency" : "currency",
                            "type" : "single"
                          }, {
                            "price" : 5.63737665663332876420099637471139430999755859375,
                            "currency" : "currency",
                            "type" : "single"
                          } ]
                        }
                      }, {
                        "distance_breakdown" : [ {
                          "distance" : 1
                        }, {
                          "distance" : 1
                        } ],
                        "route" : {
                          "arrival_time" : "2000-01-23T04:56:07.000+00:00",
                          "parts" : [ {
                            "departs_at" : "departs_at",
                            "distance" : 2,
                            "line" : "line",
                            "num_stops" : 2,
                            "turn" : "turn",
                            "type" : "basic",
                            "travel_time" : 7,
                            "directions" : "directions",
                            "arrives_at" : "arrives_at",
                            "road" : "road",
                            "departure_station" : "departure_station",
                            "id" : "id",
                            "arrival_station" : "arrival_station",
                            "coords" : [ {
                              "lng" : 3.61607674925191080461672754609026014804840087890625,
                              "lat" : 9.301444243932575517419536481611430644989013671875
                            }, {
                              "lng" : 3.61607674925191080461672754609026014804840087890625,
                              "lat" : 9.301444243932575517419536481611430644989013671875
                            } ],
                            "direction" : "direction"
                          }, {
                            "departs_at" : "departs_at",
                            "distance" : 2,
                            "line" : "line",
                            "num_stops" : 2,
                            "turn" : "turn",
                            "type" : "basic",
                            "travel_time" : 7,
                            "directions" : "directions",
                            "arrives_at" : "arrives_at",
                            "road" : "road",
                            "departure_station" : "departure_station",
                            "id" : "id",
                            "arrival_station" : "arrival_station",
                            "coords" : [ {
                              "lng" : 3.61607674925191080461672754609026014804840087890625,
                              "lat" : 9.301444243932575517419536481611430644989013671875
                            }, {
                              "lng" : 3.61607674925191080461672754609026014804840087890625,
                              "lat" : 9.301444243932575517419536481611430644989013671875
                            } ],
                            "direction" : "direction"
                          } ],
                          "departure_time" : "2000-01-23T04:56:07.000+00:00"
                        },
                        "distance" : 6,
                        "travel_time" : 0,
                        "fares" : {
                          "breakdown" : [ {
                            "modes" : [ null, null ],
                            "tickets" : [ {
                              "price" : 5.63737665663332876420099637471139430999755859375,
                              "currency" : "currency",
                              "type" : "single"
                            }, {
                              "price" : 5.63737665663332876420099637471139430999755859375,
                              "currency" : "currency",
                              "type" : "single"
                            } ],
                            "route_part_ids" : [ 5, 5 ]
                          }, {
                            "modes" : [ null, null ],
                            "tickets" : [ {
                              "price" : 5.63737665663332876420099637471139430999755859375,
                              "currency" : "currency",
                              "type" : "single"
                            }, {
                              "price" : 5.63737665663332876420099637471139430999755859375,
                              "currency" : "currency",
                              "type" : "single"
                            } ],
                            "route_part_ids" : [ 5, 5 ]
                          } ],
                          "tickets_total" : [ {
                            "price" : 5.63737665663332876420099637471139430999755859375,
                            "currency" : "currency",
                            "type" : "single"
                          }, {
                            "price" : 5.63737665663332876420099637471139430999755859375,
                            "currency" : "currency",
                            "type" : "single"
                          } ]
                        }
                      } ]
                    } ],
                    "search_id" : "search_id"
                  } ]
                }"""
                
                when(exampleContentType) {
                    "application/json" -> call.respond(gson.fromJson(exampleContentString, empty::class.java))
                    "application/xml" -> call.respondText(exampleContentString, ContentType.Text.Xml)
                    else -> call.respondText(exampleContentString)
                }
            }
        }
    }
    .apply {
      // TODO: ktor doesn't allow different authentication registrations for endpoints sharing the same path but different methods.
      //       It could be the authentication block is being abused here. Until this is resolved, swallow duplicate exceptions.

        try {
            authentication {
                // "Implement API key auth (ApiKey) for parameter name 'X-Api-Key'."
                apiKeyAuth("X-Api-Key", "header") {
                    // TODO: "Verify key here , accessible as it.value"
                    if (it.value == "keyboardcat") {
                         ApiPrincipal(it)
                    } else {
                        null
                    }
                }
                // "Implement API key auth (ApplicationId) for parameter name 'X-Application-Id'."
                apiKeyAuth("X-Application-Id", "header") {
                    // TODO: "Verify key here , accessible as it.value"
                    if (it.value == "keyboardcat") {
                         ApiPrincipal(it)
                    } else {
                        null
                    }
                }
            }
        } catch(e: io.ktor.application.DuplicateApplicationFeatureException){
            application.environment.log.warn("authentication block for '/v4/time-filter' is duplicated in code. " +
            "Generated endpoints may need to be merged under a 'route' entry.")
        }
    }

    route("/v4/time-filter/fast") {
        post {
            val principal = call.authentication.principal<ApiPrincipal>()
            val principal = call.authentication.principal<ApiPrincipal>()
            
            if (principal == null) {
                call.respond(HttpStatusCode.Unauthorized)
            } else {
                val exampleContentType = "application/json"
                val exampleContentString = """{
                  "results" : [ {
                    "unreachable" : [ "unreachable", "unreachable" ],
                    "locations" : [ {
                      "id" : "id",
                      "properties" : [ {
                        "travel_time" : 0,
                        "fares" : {
                          "tickets_total" : [ {
                            "price" : 5.63737665663332876420099637471139430999755859375,
                            "currency" : "currency",
                            "type" : "single"
                          }, {
                            "price" : 5.63737665663332876420099637471139430999755859375,
                            "currency" : "currency",
                            "type" : "single"
                          } ]
                        }
                      }, {
                        "travel_time" : 0,
                        "fares" : {
                          "tickets_total" : [ {
                            "price" : 5.63737665663332876420099637471139430999755859375,
                            "currency" : "currency",
                            "type" : "single"
                          }, {
                            "price" : 5.63737665663332876420099637471139430999755859375,
                            "currency" : "currency",
                            "type" : "single"
                          } ]
                        }
                      } ]
                    }, {
                      "id" : "id",
                      "properties" : [ {
                        "travel_time" : 0,
                        "fares" : {
                          "tickets_total" : [ {
                            "price" : 5.63737665663332876420099637471139430999755859375,
                            "currency" : "currency",
                            "type" : "single"
                          }, {
                            "price" : 5.63737665663332876420099637471139430999755859375,
                            "currency" : "currency",
                            "type" : "single"
                          } ]
                        }
                      }, {
                        "travel_time" : 0,
                        "fares" : {
                          "tickets_total" : [ {
                            "price" : 5.63737665663332876420099637471139430999755859375,
                            "currency" : "currency",
                            "type" : "single"
                          }, {
                            "price" : 5.63737665663332876420099637471139430999755859375,
                            "currency" : "currency",
                            "type" : "single"
                          } ]
                        }
                      } ]
                    } ],
                    "search_id" : "search_id"
                  }, {
                    "unreachable" : [ "unreachable", "unreachable" ],
                    "locations" : [ {
                      "id" : "id",
                      "properties" : [ {
                        "travel_time" : 0,
                        "fares" : {
                          "tickets_total" : [ {
                            "price" : 5.63737665663332876420099637471139430999755859375,
                            "currency" : "currency",
                            "type" : "single"
                          }, {
                            "price" : 5.63737665663332876420099637471139430999755859375,
                            "currency" : "currency",
                            "type" : "single"
                          } ]
                        }
                      }, {
                        "travel_time" : 0,
                        "fares" : {
                          "tickets_total" : [ {
                            "price" : 5.63737665663332876420099637471139430999755859375,
                            "currency" : "currency",
                            "type" : "single"
                          }, {
                            "price" : 5.63737665663332876420099637471139430999755859375,
                            "currency" : "currency",
                            "type" : "single"
                          } ]
                        }
                      } ]
                    }, {
                      "id" : "id",
                      "properties" : [ {
                        "travel_time" : 0,
                        "fares" : {
                          "tickets_total" : [ {
                            "price" : 5.63737665663332876420099637471139430999755859375,
                            "currency" : "currency",
                            "type" : "single"
                          }, {
                            "price" : 5.63737665663332876420099637471139430999755859375,
                            "currency" : "currency",
                            "type" : "single"
                          } ]
                        }
                      }, {
                        "travel_time" : 0,
                        "fares" : {
                          "tickets_total" : [ {
                            "price" : 5.63737665663332876420099637471139430999755859375,
                            "currency" : "currency",
                            "type" : "single"
                          }, {
                            "price" : 5.63737665663332876420099637471139430999755859375,
                            "currency" : "currency",
                            "type" : "single"
                          } ]
                        }
                      } ]
                    } ],
                    "search_id" : "search_id"
                  } ]
                }"""
                
                when(exampleContentType) {
                    "application/json" -> call.respond(gson.fromJson(exampleContentString, empty::class.java))
                    "application/xml" -> call.respondText(exampleContentString, ContentType.Text.Xml)
                    else -> call.respondText(exampleContentString)
                }
            }
        }
    }
    .apply {
      // TODO: ktor doesn't allow different authentication registrations for endpoints sharing the same path but different methods.
      //       It could be the authentication block is being abused here. Until this is resolved, swallow duplicate exceptions.

        try {
            authentication {
                // "Implement API key auth (ApiKey) for parameter name 'X-Api-Key'."
                apiKeyAuth("X-Api-Key", "header") {
                    // TODO: "Verify key here , accessible as it.value"
                    if (it.value == "keyboardcat") {
                         ApiPrincipal(it)
                    } else {
                        null
                    }
                }
                // "Implement API key auth (ApplicationId) for parameter name 'X-Application-Id'."
                apiKeyAuth("X-Application-Id", "header") {
                    // TODO: "Verify key here , accessible as it.value"
                    if (it.value == "keyboardcat") {
                         ApiPrincipal(it)
                    } else {
                        null
                    }
                }
            }
        } catch(e: io.ktor.application.DuplicateApplicationFeatureException){
            application.environment.log.warn("authentication block for '/v4/time-filter/fast' is duplicated in code. " +
            "Generated endpoints may need to be merged under a 'route' entry.")
        }
    }

    route("/v4/time-filter/postcode-districts") {
        post {
            val principal = call.authentication.principal<ApiPrincipal>()
            val principal = call.authentication.principal<ApiPrincipal>()
            
            if (principal == null) {
                call.respond(HttpStatusCode.Unauthorized)
            } else {
                val exampleContentType = "application/json"
                val exampleContentString = """{
                  "results" : [ {
                    "districts" : [ {
                      "code" : "",
                      "properties" : {
                        "coverage" : 5.63737665663332876420099637471139430999755859375,
                        "travel_time_all" : {
                          "min" : 0,
                          "median" : 5,
                          "max" : 6,
                          "mean" : 1
                        },
                        "travel_time_reachable" : {
                          "min" : 0,
                          "median" : 5,
                          "max" : 6,
                          "mean" : 1
                        }
                      }
                    }, {
                      "code" : "",
                      "properties" : {
                        "coverage" : 5.63737665663332876420099637471139430999755859375,
                        "travel_time_all" : {
                          "min" : 0,
                          "median" : 5,
                          "max" : 6,
                          "mean" : 1
                        },
                        "travel_time_reachable" : {
                          "min" : 0,
                          "median" : 5,
                          "max" : 6,
                          "mean" : 1
                        }
                      }
                    } ],
                    "search_id" : "search_id"
                  }, {
                    "districts" : [ {
                      "code" : "",
                      "properties" : {
                        "coverage" : 5.63737665663332876420099637471139430999755859375,
                        "travel_time_all" : {
                          "min" : 0,
                          "median" : 5,
                          "max" : 6,
                          "mean" : 1
                        },
                        "travel_time_reachable" : {
                          "min" : 0,
                          "median" : 5,
                          "max" : 6,
                          "mean" : 1
                        }
                      }
                    }, {
                      "code" : "",
                      "properties" : {
                        "coverage" : 5.63737665663332876420099637471139430999755859375,
                        "travel_time_all" : {
                          "min" : 0,
                          "median" : 5,
                          "max" : 6,
                          "mean" : 1
                        },
                        "travel_time_reachable" : {
                          "min" : 0,
                          "median" : 5,
                          "max" : 6,
                          "mean" : 1
                        }
                      }
                    } ],
                    "search_id" : "search_id"
                  } ]
                }"""
                
                when(exampleContentType) {
                    "application/json" -> call.respond(gson.fromJson(exampleContentString, empty::class.java))
                    "application/xml" -> call.respondText(exampleContentString, ContentType.Text.Xml)
                    else -> call.respondText(exampleContentString)
                }
            }
        }
    }
    .apply {
      // TODO: ktor doesn't allow different authentication registrations for endpoints sharing the same path but different methods.
      //       It could be the authentication block is being abused here. Until this is resolved, swallow duplicate exceptions.

        try {
            authentication {
                // "Implement API key auth (ApiKey) for parameter name 'X-Api-Key'."
                apiKeyAuth("X-Api-Key", "header") {
                    // TODO: "Verify key here , accessible as it.value"
                    if (it.value == "keyboardcat") {
                         ApiPrincipal(it)
                    } else {
                        null
                    }
                }
                // "Implement API key auth (ApplicationId) for parameter name 'X-Application-Id'."
                apiKeyAuth("X-Application-Id", "header") {
                    // TODO: "Verify key here , accessible as it.value"
                    if (it.value == "keyboardcat") {
                         ApiPrincipal(it)
                    } else {
                        null
                    }
                }
            }
        } catch(e: io.ktor.application.DuplicateApplicationFeatureException){
            application.environment.log.warn("authentication block for '/v4/time-filter/postcode-districts' is duplicated in code. " +
            "Generated endpoints may need to be merged under a 'route' entry.")
        }
    }

    route("/v4/time-filter/postcode-sectors") {
        post {
            val principal = call.authentication.principal<ApiPrincipal>()
            val principal = call.authentication.principal<ApiPrincipal>()
            
            if (principal == null) {
                call.respond(HttpStatusCode.Unauthorized)
            } else {
                val exampleContentType = "application/json"
                val exampleContentString = """{
                  "results" : [ {
                    "sectors" : [ {
                      "code" : "",
                      "properties" : {
                        "coverage" : 0.80082819046101150206595775671303272247314453125,
                        "travel_time_all" : {
                          "min" : 0,
                          "median" : 5,
                          "max" : 6,
                          "mean" : 1
                        },
                        "travel_time_reachable" : {
                          "min" : 0,
                          "median" : 5,
                          "max" : 6,
                          "mean" : 1
                        }
                      }
                    }, {
                      "code" : "",
                      "properties" : {
                        "coverage" : 0.80082819046101150206595775671303272247314453125,
                        "travel_time_all" : {
                          "min" : 0,
                          "median" : 5,
                          "max" : 6,
                          "mean" : 1
                        },
                        "travel_time_reachable" : {
                          "min" : 0,
                          "median" : 5,
                          "max" : 6,
                          "mean" : 1
                        }
                      }
                    } ],
                    "search_id" : "search_id"
                  }, {
                    "sectors" : [ {
                      "code" : "",
                      "properties" : {
                        "coverage" : 0.80082819046101150206595775671303272247314453125,
                        "travel_time_all" : {
                          "min" : 0,
                          "median" : 5,
                          "max" : 6,
                          "mean" : 1
                        },
                        "travel_time_reachable" : {
                          "min" : 0,
                          "median" : 5,
                          "max" : 6,
                          "mean" : 1
                        }
                      }
                    }, {
                      "code" : "",
                      "properties" : {
                        "coverage" : 0.80082819046101150206595775671303272247314453125,
                        "travel_time_all" : {
                          "min" : 0,
                          "median" : 5,
                          "max" : 6,
                          "mean" : 1
                        },
                        "travel_time_reachable" : {
                          "min" : 0,
                          "median" : 5,
                          "max" : 6,
                          "mean" : 1
                        }
                      }
                    } ],
                    "search_id" : "search_id"
                  } ]
                }"""
                
                when(exampleContentType) {
                    "application/json" -> call.respond(gson.fromJson(exampleContentString, empty::class.java))
                    "application/xml" -> call.respondText(exampleContentString, ContentType.Text.Xml)
                    else -> call.respondText(exampleContentString)
                }
            }
        }
    }
    .apply {
      // TODO: ktor doesn't allow different authentication registrations for endpoints sharing the same path but different methods.
      //       It could be the authentication block is being abused here. Until this is resolved, swallow duplicate exceptions.

        try {
            authentication {
                // "Implement API key auth (ApiKey) for parameter name 'X-Api-Key'."
                apiKeyAuth("X-Api-Key", "header") {
                    // TODO: "Verify key here , accessible as it.value"
                    if (it.value == "keyboardcat") {
                         ApiPrincipal(it)
                    } else {
                        null
                    }
                }
                // "Implement API key auth (ApplicationId) for parameter name 'X-Application-Id'."
                apiKeyAuth("X-Application-Id", "header") {
                    // TODO: "Verify key here , accessible as it.value"
                    if (it.value == "keyboardcat") {
                         ApiPrincipal(it)
                    } else {
                        null
                    }
                }
            }
        } catch(e: io.ktor.application.DuplicateApplicationFeatureException){
            application.environment.log.warn("authentication block for '/v4/time-filter/postcode-sectors' is duplicated in code. " +
            "Generated endpoints may need to be merged under a 'route' entry.")
        }
    }

    route("/v4/time-filter/postcodes") {
        post {
            val principal = call.authentication.principal<ApiPrincipal>()
            val principal = call.authentication.principal<ApiPrincipal>()
            
            if (principal == null) {
                call.respond(HttpStatusCode.Unauthorized)
            } else {
                val exampleContentType = "application/json"
                val exampleContentString = """{
                  "results" : [ {
                    "postcodes" : [ {
                      "code" : "",
                      "properties" : [ {
                        "distance" : 6,
                        "travel_time" : 0
                      }, {
                        "distance" : 6,
                        "travel_time" : 0
                      } ]
                    }, {
                      "code" : "",
                      "properties" : [ {
                        "distance" : 6,
                        "travel_time" : 0
                      }, {
                        "distance" : 6,
                        "travel_time" : 0
                      } ]
                    } ],
                    "search_id" : "search_id"
                  }, {
                    "postcodes" : [ {
                      "code" : "",
                      "properties" : [ {
                        "distance" : 6,
                        "travel_time" : 0
                      }, {
                        "distance" : 6,
                        "travel_time" : 0
                      } ]
                    }, {
                      "code" : "",
                      "properties" : [ {
                        "distance" : 6,
                        "travel_time" : 0
                      }, {
                        "distance" : 6,
                        "travel_time" : 0
                      } ]
                    } ],
                    "search_id" : "search_id"
                  } ]
                }"""
                
                when(exampleContentType) {
                    "application/json" -> call.respond(gson.fromJson(exampleContentString, empty::class.java))
                    "application/xml" -> call.respondText(exampleContentString, ContentType.Text.Xml)
                    else -> call.respondText(exampleContentString)
                }
            }
        }
    }
    .apply {
      // TODO: ktor doesn't allow different authentication registrations for endpoints sharing the same path but different methods.
      //       It could be the authentication block is being abused here. Until this is resolved, swallow duplicate exceptions.

        try {
            authentication {
                // "Implement API key auth (ApiKey) for parameter name 'X-Api-Key'."
                apiKeyAuth("X-Api-Key", "header") {
                    // TODO: "Verify key here , accessible as it.value"
                    if (it.value == "keyboardcat") {
                         ApiPrincipal(it)
                    } else {
                        null
                    }
                }
                // "Implement API key auth (ApplicationId) for parameter name 'X-Application-Id'."
                apiKeyAuth("X-Application-Id", "header") {
                    // TODO: "Verify key here , accessible as it.value"
                    if (it.value == "keyboardcat") {
                         ApiPrincipal(it)
                    } else {
                        null
                    }
                }
            }
        } catch(e: io.ktor.application.DuplicateApplicationFeatureException){
            application.environment.log.warn("authentication block for '/v4/time-filter/postcodes' is duplicated in code. " +
            "Generated endpoints may need to be merged under a 'route' entry.")
        }
    }

    route("/v4/time-map") {
        post {
            val principal = call.authentication.principal<ApiPrincipal>()
            val principal = call.authentication.principal<ApiPrincipal>()
            
            if (principal == null) {
                call.respond(HttpStatusCode.Unauthorized)
            } else {
                val exampleContentType = "application/json"
                val exampleContentString = """{
                  "results" : [ {
                    "shapes" : [ {
                      "shell" : [ {
                        "lng" : 3.61607674925191080461672754609026014804840087890625,
                        "lat" : 9.301444243932575517419536481611430644989013671875
                      }, {
                        "lng" : 3.61607674925191080461672754609026014804840087890625,
                        "lat" : 9.301444243932575517419536481611430644989013671875
                      } ],
                      "holes" : [ [ {
                        "lng" : 3.61607674925191080461672754609026014804840087890625,
                        "lat" : 9.301444243932575517419536481611430644989013671875
                      }, {
                        "lng" : 3.61607674925191080461672754609026014804840087890625,
                        "lat" : 9.301444243932575517419536481611430644989013671875
                      } ], [ {
                        "lng" : 3.61607674925191080461672754609026014804840087890625,
                        "lat" : 9.301444243932575517419536481611430644989013671875
                      }, {
                        "lng" : 3.61607674925191080461672754609026014804840087890625,
                        "lat" : 9.301444243932575517419536481611430644989013671875
                      } ] ]
                    }, {
                      "shell" : [ {
                        "lng" : 3.61607674925191080461672754609026014804840087890625,
                        "lat" : 9.301444243932575517419536481611430644989013671875
                      }, {
                        "lng" : 3.61607674925191080461672754609026014804840087890625,
                        "lat" : 9.301444243932575517419536481611430644989013671875
                      } ],
                      "holes" : [ [ {
                        "lng" : 3.61607674925191080461672754609026014804840087890625,
                        "lat" : 9.301444243932575517419536481611430644989013671875
                      }, {
                        "lng" : 3.61607674925191080461672754609026014804840087890625,
                        "lat" : 9.301444243932575517419536481611430644989013671875
                      } ], [ {
                        "lng" : 3.61607674925191080461672754609026014804840087890625,
                        "lat" : 9.301444243932575517419536481611430644989013671875
                      }, {
                        "lng" : 3.61607674925191080461672754609026014804840087890625,
                        "lat" : 9.301444243932575517419536481611430644989013671875
                      } ] ]
                    } ],
                    "properties" : {
                      "is_only_walking" : true
                    },
                    "search_id" : "search_id"
                  }, {
                    "shapes" : [ {
                      "shell" : [ {
                        "lng" : 3.61607674925191080461672754609026014804840087890625,
                        "lat" : 9.301444243932575517419536481611430644989013671875
                      }, {
                        "lng" : 3.61607674925191080461672754609026014804840087890625,
                        "lat" : 9.301444243932575517419536481611430644989013671875
                      } ],
                      "holes" : [ [ {
                        "lng" : 3.61607674925191080461672754609026014804840087890625,
                        "lat" : 9.301444243932575517419536481611430644989013671875
                      }, {
                        "lng" : 3.61607674925191080461672754609026014804840087890625,
                        "lat" : 9.301444243932575517419536481611430644989013671875
                      } ], [ {
                        "lng" : 3.61607674925191080461672754609026014804840087890625,
                        "lat" : 9.301444243932575517419536481611430644989013671875
                      }, {
                        "lng" : 3.61607674925191080461672754609026014804840087890625,
                        "lat" : 9.301444243932575517419536481611430644989013671875
                      } ] ]
                    }, {
                      "shell" : [ {
                        "lng" : 3.61607674925191080461672754609026014804840087890625,
                        "lat" : 9.301444243932575517419536481611430644989013671875
                      }, {
                        "lng" : 3.61607674925191080461672754609026014804840087890625,
                        "lat" : 9.301444243932575517419536481611430644989013671875
                      } ],
                      "holes" : [ [ {
                        "lng" : 3.61607674925191080461672754609026014804840087890625,
                        "lat" : 9.301444243932575517419536481611430644989013671875
                      }, {
                        "lng" : 3.61607674925191080461672754609026014804840087890625,
                        "lat" : 9.301444243932575517419536481611430644989013671875
                      } ], [ {
                        "lng" : 3.61607674925191080461672754609026014804840087890625,
                        "lat" : 9.301444243932575517419536481611430644989013671875
                      }, {
                        "lng" : 3.61607674925191080461672754609026014804840087890625,
                        "lat" : 9.301444243932575517419536481611430644989013671875
                      } ] ]
                    } ],
                    "properties" : {
                      "is_only_walking" : true
                    },
                    "search_id" : "search_id"
                  } ]
                }"""
                
                when(exampleContentType) {
                    "application/json" -> call.respond(gson.fromJson(exampleContentString, empty::class.java))
                    "application/xml" -> call.respondText(exampleContentString, ContentType.Text.Xml)
                    else -> call.respondText(exampleContentString)
                }
            }
        }
    }
    .apply {
      // TODO: ktor doesn't allow different authentication registrations for endpoints sharing the same path but different methods.
      //       It could be the authentication block is being abused here. Until this is resolved, swallow duplicate exceptions.

        try {
            authentication {
                // "Implement API key auth (ApiKey) for parameter name 'X-Api-Key'."
                apiKeyAuth("X-Api-Key", "header") {
                    // TODO: "Verify key here , accessible as it.value"
                    if (it.value == "keyboardcat") {
                         ApiPrincipal(it)
                    } else {
                        null
                    }
                }
                // "Implement API key auth (ApplicationId) for parameter name 'X-Application-Id'."
                apiKeyAuth("X-Application-Id", "header") {
                    // TODO: "Verify key here , accessible as it.value"
                    if (it.value == "keyboardcat") {
                         ApiPrincipal(it)
                    } else {
                        null
                    }
                }
            }
        } catch(e: io.ktor.application.DuplicateApplicationFeatureException){
            application.environment.log.warn("authentication block for '/v4/time-map' is duplicated in code. " +
            "Generated endpoints may need to be merged under a 'route' entry.")
        }
    }
}
